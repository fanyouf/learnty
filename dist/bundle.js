(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var interface_1 = require("./interface");
var util_1 = require("./util");
var Spark_1 = require("./Spark");
var Firework = /** @class */ (function () {
    function Firework(_a) {
        var x = _a.x, y = _a.y;
        this.reset({ x: x, y: y });
    }
    Firework.prototype.reset = function (_a) {
        var x = _a.x, y = _a.y;
        this.x = x;
        this.y = y;
        this.curAge = 0;
        this.dy = 100 + util_1.R(20);
        this.dx = -5 + util_1.R(10);
        this.phase = interface_1.PHASE.rise;
        this.sparkPerNumber = 10;
        this.sparks = [];
        for (var n = 0; n < this.sparkPerNumber; n++) {
            var dela = ((180 / this.sparkPerNumber) * n * Math.PI) / 180;
            var t = Math.random() * 50 + 30;
            var spark = new Spark_1.default({
                vx: t * Math.cos(dela),
                vy: t * Math.sin(dela),
                weight: Math.random() * 0.3 + 0.03,
                red: Math.floor(Math.random() * 2),
                green: Math.floor(Math.random() * 2),
                blue: Math.floor(Math.random() * 2)
            });
            if (Math.random() > 0.5)
                spark.vx = -spark.vx;
            if (Math.random() > 0.5)
                spark.vy = -spark.vy;
            this.sparks.push(spark);
        }
    };
    Firework.prototype.run = function (context) {
        var _this = this;
        if (this.curAge > 9 && Math.random() < 0.01) {
            this.reset({
                x: 200 + Math.floor(Math.random() * 400),
                y: 500 + Math.floor(Math.random() * 200)
            });
        }
        else {
            this.curAge += 1 / 25;
            this.phase = this.curAge > this.dy / util_1.G ? interface_1.PHASE.expolde : interface_1.PHASE.rise;
            this.sparks.forEach(function (element) {
                element.run(context, _this);
            });
            //   console.info(this.curAge);
        }
    };
    return Firework;
}());
exports.default = Firework;

},{"./Spark":3,"./interface":4,"./util":6}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Firework_1 = require("./Firework");
var Game = {
    actors: [],
    init: function (_a) {
        var context = _a.context, _b = _a.numberOfFirework, numberOfFirework = _b === void 0 ? 1 : _b;
        console.info(context);
        this.context = context;
        this.numberOfFirework = numberOfFirework;
        for (var i = 0; i < numberOfFirework; i++) {
            var firework = new Firework_1.default({
                x: 200 + Math.floor(Math.random() * 400),
                y: 500 + Math.floor(Math.random() * 200)
            });
            this.actors.push(firework);
        }
    },
    start: function () {
        var _this = this;
        this.context.clearRect(0, 0, this.context.canvas.width, this.context.canvas.height);
        this.actors.forEach(function (actor) {
            actor.run(_this.context);
        });
        requestAnimationFrame(Game.start.bind(this));
    }
};
exports.default = Game;

},{"./Firework":1}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var interface_1 = require("./interface");
var util_1 = require("./util");
var Spark = /** @class */ (function () {
    function Spark(_a) {
        var vx = _a.vx, vy = _a.vy, weight = _a.weight, red = _a.red, green = _a.green, blue = _a.blue;
        this.vx = vx;
        this.vy = vy;
        this.weight = weight;
        this.red = red;
        this.green = green;
        this.blue = blue;
        this.curAge = 0;
    }
    Spark.prototype[interface_1.PHASE.rise] = function (context, firework) {
        var i = 15;
        context.beginPath();
        //     this.y =
        this.x = firework.x + firework.curAge * firework.dx;
        this.y =
            firework.y -
                firework.dy * firework.curAge +
                0.5 * util_1.G * firework.curAge * firework.curAge;
        context.fillStyle = "rgba(" + 255 + "," + i * 17 + ",255,1)";
        context.rect(this.x, this.y + Math.random() * i - i / 2, 4, 4);
        context.fill();
        // console.info(firework.x, firework.y);
        this.curAge = firework.curAge;
    };
    Spark.prototype[interface_1.PHASE.expolde] = function (context, firework) {
        var t = firework.curAge - this.curAge;
        var dxx = Math.max(0.5, 1 - t / 10);
        console.info(dxx);
        var x = this.x + this.vx * t * dxx;
        var y = this.y - this.vy * t + (1 / 2) * util_1.G * t * t;
        var fade = 1 * 20 - firework.curAge * 2;
        var r = Math.max(0, Math.floor(255 - t * 10));
        var g = util_1.R(255);
        var b = util_1.R(255);
        var de = 1 - t / 10;
        context.beginPath();
        context.fillStyle = "rgba(" + r + "," + g + "," + b + "," + de + ")";
        context.rect(x, y, 4, 4);
        context.fill();
        // console.info("explode");
        // console.info(x, y);
    };
    Spark.prototype.run = function (context, firework) {
        this[firework.phase](context, firework);
    };
    return Spark;
}());
exports.default = Spark;

},{"./interface":4,"./util":6}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var PHASE;
(function (PHASE) {
    PHASE["expolde"] = "expolde";
    PHASE["rise"] = "rise";
})(PHASE || (PHASE = {}));
exports.PHASE = PHASE;

},{}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Game_1 = require("./Game");
var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
Game_1.default.init({ context: context, numberOfFirework: 1 });
Game_1.default.start();

},{"./Game":2}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
function R(max) {
    if (max === void 0) { max = 1; }
    return Math.random() * max;
}
exports.R = R;
var G = 9.8 * 2;
exports.G = G;

},{}]},{},[5])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvdHMvRmlyZXdvcmsudHMiLCJzcmMvdHMvR2FtZS50cyIsInNyYy90cy9TcGFyay50cyIsInNyYy90cy9pbnRlcmZhY2UudHMiLCJzcmMvdHMvbWFpbi50cyIsInNyYy90cy91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7QUNBQSx5Q0FBMkM7QUFDM0MsK0JBQThCO0FBQzlCLGlDQUE0QjtBQUM1QjtJQVdFLGtCQUFZLEVBQVE7WUFBTixRQUFDLEVBQUUsUUFBQztRQUNoQixJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxHQUFBLEVBQUUsQ0FBQyxHQUFBLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFFRCx3QkFBSyxHQUFMLFVBQU0sRUFBUTtZQUFOLFFBQUMsRUFBRSxRQUFDO1FBQ1YsSUFBSSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDWCxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNYLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLElBQUksQ0FBQyxFQUFFLEdBQUcsR0FBRyxHQUFHLFFBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUN0QixJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLFFBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNyQixJQUFJLENBQUMsS0FBSyxHQUFHLGlCQUFLLENBQUMsSUFBSSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxjQUFjLEdBQUcsRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1FBRWpCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzVDLElBQUksSUFBSSxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLGNB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LENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFFekIsT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ2YsMkJBQTJCO1FBQzNCLHNCQUFzQjtJQUN4QixDQUFDO0lBQ0QsbUJBQUcsR0FBSCxVQUFJLE9BQU8sRUFBRSxRQUFRO1FBQ25CLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzFDLENBQUM7SUFDSCxZQUFDO0FBQUQsQ0F0RUEsQUFzRUMsSUFBQTtBQUVELGtCQUFlLEtBQUssQ0FBQzs7Ozs7QUN2RXJCLElBQUssS0FHSjtBQUhELFdBQUssS0FBSztJQUNOLDRCQUFpQixDQUFBO0lBQ2pCLHNCQUFXLENBQUE7QUFDZixDQUFDLEVBSEksS0FBSyxLQUFMLEtBQUssUUFHVDtBQUVjLHNCQUFLOzs7OztBQ1RwQiwrQkFBMEI7QUFDMUIsSUFBSSxNQUFNLEdBQXNCLFFBQVEsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUM7QUFFcEUsSUFBSSxPQUFPLEdBQUcsTUFBTSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN0QyxjQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxTQUFBLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUM1QyxjQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7Ozs7O0FDTGIsU0FBUyxDQUFDLENBQUMsR0FBZTtJQUFmLG9CQUFBLEVBQUEsT0FBZTtJQUN4QixPQUFPLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxHQUFHLENBQUM7QUFDN0IsQ0FBQztBQUVRLGNBQUM7QUFEVixJQUFNLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO0FBQ04sY0FBQyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCB7IFBIQVNFLCBBQ1RPUiB9IGZyb20gXCIuL2ludGVyZmFjZVwiO1xuaW1wb3J0IHsgUiwgRyB9IGZyb20gXCIuL3V0aWxcIjtcbmltcG9ydCBTcGFyayBmcm9tIFwiLi9TcGFya1wiO1xuY2xhc3MgRmlyZXdvcmsgaW1wbGVtZW50cyBBQ1RPUiB7XG4gIHBoYXNlOiBQSEFTRTtcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG4gIGR5OiBudW1iZXI7XG4gIGR4OiBudW1iZXI7XG4gIGN1ckFnZTogbnVtYmVyO1xuICBtYXhBZ2U6IG51bWJlcjtcbiAgc3BhcmtQZXJOdW1iZXI6IG51bWJlcjtcbiAgc3BhcmtzOiBBcnJheTxTcGFyaz47XG5cbiAgY29uc3RydWN0b3IoeyB4LCB5IH0pIHtcbiAgICB0aGlzLnJlc2V0KHsgeCwgeSB9KTtcbiAgfVxuXG4gIHJlc2V0KHsgeCwgeSB9KSB7XG4gICAgdGhpcy54ID0geDtcbiAgICB0aGlzLnkgPSB5O1xuICAgIHRoaXMuY3VyQWdlID0gMDtcbiAgICB0aGlzLmR5ID0gMTAwICsgUigyMCk7XG4gICAgdGhpcy5keCA9IC01ICsgUigxMCk7XG4gICAgdGhpcy5waGFzZSA9IFBIQVNFLnJpc2U7XG4gICAgdGhpcy5zcGFya1Blck51bWJlciA9IDEwO1xuICAgIHRoaXMuc3BhcmtzID0gW107XG5cbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHRoaXMuc3BhcmtQZXJOdW1iZXI7IG4rKykge1xuICAgICAgbGV0IGRlbGEgPSAoKDE4MCAvIHRoaXMuc3BhcmtQZXJOdW1iZXIpICogbiAqIE1hdGguUEkpIC8gMTgwO1xuICAgICAgbGV0IHQgPSBNYXRoLnJhbmRvbSgpICogNTAgKyAzMDtcbiAgICAgIGxldCBzcGFyayA9IG5ldyBTcGFyayh7XG4gICAgICAgIHZ4OiB0ICogTWF0aC5jb3MoZGVsYSksXG4gICAgICAgIHZ5OiB0ICogTWF0aC5zaW4oZGVsYSksIC8vTWF0aC5yYW5kb20oKSAqIDQwICsgMzAsXG4gICAgICAgIHdlaWdodDogTWF0aC5yYW5kb20oKSAqIDAuMyArIDAuMDMsXG4gICAgICAgIHJlZDogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMiksXG4gICAgICAgIGdyZWVuOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyKSxcbiAgICAgICAgYmx1ZTogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMilcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkgc3BhcmsudnggPSAtc3Bhcmsudng7XG5cbiAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSBzcGFyay52eSA9IC1zcGFyay52eTtcblxuICAgICAgdGhpcy5zcGFya3MucHVzaChzcGFyayk7XG4gICAgfVxuICB9XG5cbiAgcnVuKGNvbnRleHQpIHtcbiAgICBpZiAodGhpcy5jdXJBZ2UgPiA5ICYmIE1hdGgucmFuZG9tKCkgPCAwLjAxKSB7XG4gICAgICB0aGlzLnJlc2V0KHtcbiAgICAgICAgeDogMjAwICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNDAwKSxcbiAgICAgICAgeTogNTAwICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMjAwKVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3VyQWdlICs9IDEgLyAyNTtcblxuICAgICAgdGhpcy5waGFzZSA9IHRoaXMuY3VyQWdlID4gdGhpcy5keSAvIEcgPyBQSEFTRS5leHBvbGRlIDogUEhBU0UucmlzZTtcblxuICAgICAgdGhpcy5zcGFya3MuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgZWxlbWVudC5ydW4oY29udGV4dCwgdGhpcyk7XG4gICAgICB9KTtcbiAgICAgIC8vICAgY29uc29sZS5pbmZvKHRoaXMuY3VyQWdlKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRmlyZXdvcms7XG4iLCJpbXBvcnQgRmlyZXdvcmsgZnJvbSBcIi4vRmlyZXdvcmtcIjtcbmltcG9ydCB7IEFDVE9SIH0gZnJvbSBcIi4vaW50ZXJmYWNlXCI7XG5sZXQgR2FtZSA9IHtcbiAgYWN0b3JzOiBbXSxcbiAgaW5pdCh7IGNvbnRleHQsIG51bWJlck9mRmlyZXdvcmsgPSAxIH0pIHtcbiAgICBjb25zb2xlLmluZm8oY29udGV4dCk7XG4gICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICB0aGlzLm51bWJlck9mRmlyZXdvcmsgPSBudW1iZXJPZkZpcmV3b3JrO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtYmVyT2ZGaXJld29yazsgaSsrKSB7XG4gICAgICBsZXQgZmlyZXdvcmsgPSBuZXcgRmlyZXdvcmsoe1xuICAgICAgICB4OiAyMDAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiA0MDApLFxuICAgICAgICB5OiA1MDAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyMDApXG4gICAgICB9KTtcbiAgICAgIHRoaXMuYWN0b3JzLnB1c2goZmlyZXdvcmspO1xuICAgIH1cbiAgfSxcbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5jb250ZXh0LmNsZWFyUmVjdChcbiAgICAgIDAsXG4gICAgICAwLFxuICAgICAgdGhpcy5jb250ZXh0LmNhbnZhcy53aWR0aCxcbiAgICAgIHRoaXMuY29udGV4dC5jYW52YXMuaGVpZ2h0XG4gICAgKTtcblxuICAgIHRoaXMuYWN0b3JzLmZvckVhY2goKGFjdG9yOiBBQ1RPUikgPT4ge1xuICAgICAgYWN0b3IucnVuKHRoaXMuY29udGV4dCk7XG4gICAgfSk7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEdhbWUuc3RhcnQuYmluZCh0aGlzKSk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEdhbWU7XG4iLCJpbXBvcnQgeyBBQ1RPUiwgUEhBU0UgfSBmcm9tIFwiLi9pbnRlcmZhY2VcIjtcbmltcG9ydCBGaXJld29yayBmcm9tIFwiLi9GaXJld29ya1wiO1xuaW1wb3J0IHsgUiwgRyB9IGZyb20gXCIuL3V0aWxcIjtcbmNsYXNzIFNwYXJrIGltcGxlbWVudHMgQUNUT1Ige1xuICB4OiBudW1iZXI7XG4gIHk6IG51bWJlcjtcbiAgdng6IG51bWJlcjtcbiAgdnk6IG51bWJlcjtcbiAgd2VpZ2h0OiBudW1iZXI7XG4gIHJlZDogbnVtYmVyO1xuICBncmVlbjogbnVtYmVyO1xuICBibHVlOiBudW1iZXI7XG4gIGN1ckFnZTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHsgdngsIHZ5LCB3ZWlnaHQsIHJlZCwgZ3JlZW4sIGJsdWUgfSkge1xuICAgIHRoaXMudnggPSB2eDtcbiAgICB0aGlzLnZ5ID0gdnk7XG4gICAgdGhpcy53ZWlnaHQgPSB3ZWlnaHQ7XG4gICAgdGhpcy5yZWQgPSByZWQ7XG4gICAgdGhpcy5ncmVlbiA9IGdyZWVuO1xuICAgIHRoaXMuYmx1ZSA9IGJsdWU7XG4gICAgdGhpcy5jdXJBZ2UgPSAwO1xuICB9XG4gIFtQSEFTRS5yaXNlXShjb250ZXh0LCBmaXJld29yazogRmlyZXdvcmspIHtcbiAgICBsZXQgaSA9IDE1O1xuICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG5cbiAgICAvLyAgICAgdGhpcy55ID1cbiAgICB0aGlzLnggPSBmaXJld29yay54ICsgZmlyZXdvcmsuY3VyQWdlICogZmlyZXdvcmsuZHg7XG4gICAgdGhpcy55ID1cbiAgICAgIGZpcmV3b3JrLnkgLVxuICAgICAgZmlyZXdvcmsuZHkgKiBmaXJld29yay5jdXJBZ2UgK1xuICAgICAgMC41ICogRyAqIGZpcmV3b3JrLmN1ckFnZSAqIGZpcmV3b3JrLmN1ckFnZTtcblxuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCJyZ2JhKFwiICsgMjU1ICsgXCIsXCIgKyBpICogMTcgKyBcIiwyNTUsMSlcIjtcblxuICAgIGNvbnRleHQucmVjdCh0aGlzLngsIHRoaXMueSArIE1hdGgucmFuZG9tKCkgKiBpIC0gaSAvIDIsIDQsIDQpO1xuXG4gICAgY29udGV4dC5maWxsKCk7XG4gICAgLy8gY29uc29sZS5pbmZvKGZpcmV3b3JrLngsIGZpcmV3b3JrLnkpO1xuXG4gICAgdGhpcy5jdXJBZ2UgPSBmaXJld29yay5jdXJBZ2U7XG4gIH1cbiAgW1BIQVNFLmV4cG9sZGVdKGNvbnRleHQsIGZpcmV3b3JrOiBGaXJld29yaykge1xuICAgIGxldCB0ID0gZmlyZXdvcmsuY3VyQWdlIC0gdGhpcy5jdXJBZ2U7XG4gICAgbGV0IGR4eCA9IE1hdGgubWF4KDAuNSwgMSAtIHQgLyAxMCk7XG4gICAgY29uc29sZS5pbmZvKGR4eCk7XG4gICAgbGV0IHggPSB0aGlzLnggKyB0aGlzLnZ4ICogdCAqIGR4eDtcblxuICAgIGxldCB5ID0gdGhpcy55IC0gdGhpcy52eSAqIHQgKyAoMSAvIDIpICogRyAqIHQgKiB0O1xuXG4gICAgbGV0IGZhZGUgPSAxICogMjAgLSBmaXJld29yay5jdXJBZ2UgKiAyO1xuXG4gICAgbGV0IHIgPSBNYXRoLm1heCgwLCBNYXRoLmZsb29yKDI1NSAtIHQgKiAxMCkpO1xuXG4gICAgbGV0IGcgPSBSKDI1NSk7XG5cbiAgICBsZXQgYiA9IFIoMjU1KTtcbiAgICBsZXQgZGUgPSAxIC0gdCAvIDEwO1xuXG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcblxuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gYHJnYmEoJHtyfSwke2d9LCR7Yn0sJHtkZX0pYDtcblxuICAgIGNvbnRleHQucmVjdCh4LCB5LCA0LCA0KTtcblxuICAgIGNvbnRleHQuZmlsbCgpO1xuICAgIC8vIGNvbnNvbGUuaW5mbyhcImV4cGxvZGVcIik7XG4gICAgLy8gY29uc29sZS5pbmZvKHgsIHkpO1xuICB9XG4gIHJ1bihjb250ZXh0LCBmaXJld29yaykge1xuICAgIHRoaXNbZmlyZXdvcmsucGhhc2VdKGNvbnRleHQsIGZpcmV3b3JrKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBTcGFyaztcbiIsImludGVyZmFjZSBBQ1RPUiB7XG4gICAgcnVuOihjb250ZXh0LGZpcmV3b3JrPyk9PnZvaWRcbn1cblxuZW51bSBQSEFTRXtcbiAgICBleHBvbGRlPVwiZXhwb2xkZVwiLFxuICAgIHJpc2U9XCJyaXNlXCJcbn1cblxuZXhwb3J0IHsgQUNUT1IsUEhBU0V9IiwiaW1wb3J0IEdhbWUgZnJvbSBcIi4vR2FtZVwiO1xubGV0IGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm15Q2FudmFzXCIpO1xuXG5sZXQgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5HYW1lLmluaXQoeyBjb250ZXh0LCBudW1iZXJPZkZpcmV3b3JrOiAxIH0pO1xuR2FtZS5zdGFydCgpO1xuIiwiZnVuY3Rpb24gUihtYXg6IG51bWJlciA9IDEpIHtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiBtYXg7XG59XG5jb25zdCBHID0gOS44ICogMjtcbmV4cG9ydCB7IFIsIEcgfTtcbiJdfQ==
